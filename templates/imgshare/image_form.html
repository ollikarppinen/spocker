{% extends "base.html" %}


{% block content %}

  {% if not request.user.is_authenticated %}
    {% include "login_warning.html" %}
  {% else %}
    <div class="panel panel-default">


      <div class="panel-body">
        Upload
      </div>
      <div class="panel-footer">
        <form action="" method="post">
          <div class="input-group">
            {% csrf_token %}
            <span class="input-group-button">
              {{ form.as_table }}
              <button type="submit" class="btn-sm btn-success">Save</button>
            </span>
          </div>
        </form>
      </div>
    </div>

    <script>
      (function() {
          uploadcare.start();

          var widget = uploadcare.Widget('#id_image');
          widget.openDialog();
          widget.onChange(function(file) {
              if (file) {
                  var form = document.getElementById('upload-form');
                  form.submit();
                  form.style.display = 'none';
              }
          });
      })();
    </script>

  {% endif %}

{% endblock content %}
